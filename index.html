<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>OPUS - Online Pathway to University Students</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link href="https://fonts.googleapis.com/css2?family=Noto+Sans:wght@400;600;700&family=PT+Serif:wght@400;700&family=Pacifico&family=Poppins:wght@300;400;500;600;700&family=Share+Tech+Mono&family=VT323&display=swap" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.9.3/dist/confetti.browser.min.js"></script>
<style>
*, *::before, *::after { margin: 0; padding: 0; box-sizing: border-box; }
html, body { width: 100%; height: 100%; overflow: hidden; font-family: 'Noto Sans', sans-serif; }
.stage { display: none; width: 100%; height: 100%; position: absolute; top: 0; left: 0; }
.stage.active { display: flex; }

/* ===== STAGE 1: OPUS LOGIN ===== */
#stage1 { flex-direction: column; background: #fff; }
.opus-header {
  background: #002878; padding: 12px 30px; display: flex;
  align-items: center; gap: 14px; min-height: 70px;
}
.opus-header-logo { display: flex; align-items: center; gap: 10px; }
.opus-header-logo img { height: 48px; width: auto; }
.opus-header-brand { display: flex; flex-direction: column; line-height: 1.1; }
.opus-header-brand .emory-text {
  font-family: 'PT Serif', serif; font-weight: 700; font-size: 22px;
  color: #c5b358; letter-spacing: 3px;
}
.opus-header-brand .univ-text {
  font-family: 'Noto Sans', sans-serif; font-weight: 400; font-size: 10px;
  color: #c5b358; letter-spacing: 4px; text-transform: uppercase;
}
.opus-header-divider { width: 1px; height: 44px; background: rgba(197,179,88,0.5); margin: 0 8px; }
.opus-header-title { display: flex; flex-direction: column; line-height: 1.15; }
.opus-header-title .opus-text {
  font-family: 'Noto Sans', sans-serif; font-weight: 700; font-size: 26px;
  color: #fff; letter-spacing: 2px;
}
.opus-header-title .opus-sub {
  font-family: 'Noto Sans', sans-serif; font-weight: 400; font-size: 10px;
  color: rgba(255,255,255,0.75); letter-spacing: 0.5px;
}
.opus-body { flex: 1; display: flex; padding: 40px 50px; gap: 40px; background: #f4f4f4; }
.opus-left { flex: 1; max-width: 380px; }
.opus-left h2 { font-size: 16px; font-weight: 600; color: #333; margin-bottom: 18px; }
.opus-left label { display: block; font-size: 13px; color: #444; margin-bottom: 5px; font-weight: 600; }
.opus-left input[type="text"],
.opus-left input[type="password"] {
  width: 100%; padding: 8px 10px; font-size: 14px; border: 1px solid #b0b0b0;
  border-radius: 3px; margin-bottom: 14px; font-family: 'Noto Sans', sans-serif;
  outline: none; background: #fff;
}
.opus-left input:focus { border-color: #002878; box-shadow: 0 0 0 2px rgba(0,40,120,0.12); }
.opus-login-btn {
  background: #002878; color: #fff; border: none; padding: 9px 32px;
  font-size: 14px; font-weight: 600; border-radius: 3px; cursor: pointer;
  font-family: 'Noto Sans', sans-serif; transition: background 0.2s;
}
.opus-login-btn:hover { background: #001a56; }
.opus-right { flex: 1; max-width: 440px; }
.opus-info-box {
  background: #e8e8e8; border: 1px solid #ccc; border-radius: 4px;
  padding: 18px 20px; font-size: 13px; color: #333; line-height: 1.65;
}
.opus-info-box a { color: #002878; text-decoration: underline; cursor: pointer; }
.opus-info-box .warn {
  margin-top: 14px; padding-top: 12px; border-top: 1px solid #bbb;
  font-size: 11.5px; color: #666;
}

/* ===== STAGE 2: HACKING ===== */
#stage2 {
  flex-direction: column; background: #000; font-family: 'Share Tech Mono', monospace;
  color: #0f0; overflow: hidden; position: relative;
}
#matrixCanvas { position: absolute; top: 0; left: 0; width: 100%; height: 100%; z-index: 1; opacity: 0.15; }
#terminal {
  position: absolute; bottom: 0; left: 0; width: 55%; height: 48%;
  overflow-y: auto; padding: 10px 16px; font-size: 12.5px; line-height: 1.5;
  z-index: 5; border-top: 1px solid rgba(0,255,0,0.15);
  scrollbar-width: thin; scrollbar-color: #0f0 #000;
}
#terminal::-webkit-scrollbar { width: 5px; }
#terminal::-webkit-scrollbar-track { background: #000; }
#terminal::-webkit-scrollbar-thumb { background: #0f0; }
.term-line { opacity: 0; animation: fadeInLine 0.12s forwards; white-space: pre-wrap; word-break: break-all; }
.term-line.red { color: #f33; } .term-line.yellow { color: #ff0; }
.term-line.cyan { color: #0ff; } .term-line.dim { color: #050; }
@keyframes fadeInLine { to { opacity: 1; } }

.hud-panel {
  position: absolute; border: 1px solid rgba(0,255,0,0.3); background: rgba(0,5,0,0.85);
  z-index: 6; font-size: 10px; overflow: hidden;
}
.hud-panel-title {
  background: rgba(0,255,0,0.12); padding: 3px 8px; font-size: 9px;
  color: #0f0; letter-spacing: 2px; text-transform: uppercase;
  border-bottom: 1px solid rgba(0,255,0,0.15);
}
#netGraph { right: 16px; top: 16px; width: 280px; height: 120px; }
#netGraphCanvas { width: 100%; height: calc(100% - 22px); display: block; }
#ipScanner { right: 16px; top: 150px; width: 280px; height: 155px; }
#ipScannerBody { padding: 4px 8px; overflow-y: auto; height: calc(100% - 22px); }
.ip-line { font-size: 10px; line-height: 1.6; color: #0a0; }
.ip-line.hit { color: #0f0; } .ip-line.blocked { color: #f33; }
#fileTree { right: 16px; bottom: 16px; width: 280px; height: 200px; }
#fileTreeBody { padding: 6px 8px; overflow-y: auto; height: calc(100% - 22px); }
.tree-item { color: #0a0; font-size: 10px; line-height: 1.7; }
.tree-item.encrypting { color: #ff0; } .tree-item.encrypted { color: #f33; text-decoration: line-through; }
#downloadPanel { left: 16px; top: 16px; width: 340px; max-height: 45%; overflow-y: auto; }
#downloadBody { padding: 6px 8px; }
.dl-item { margin-bottom: 6px; }
.dl-item-name { font-size: 10px; color: #0ff; margin-bottom: 2px; display: flex; justify-content: space-between; }
.dl-item-bar { width: 100%; height: 10px; background: #001a00; border: 1px solid rgba(0,255,0,0.3); border-radius: 2px; overflow: hidden; }
.dl-item-fill { height: 100%; background: #0f0; width: 0%; transition: width 0.4s linear; }
.dl-item-fill.complete { background: #0ff; } .dl-item-fill.fail { background: #f33; }
.dl-item-size { font-size: 9px; color: #080; margin-top: 1px; }

.hack-popup {
  position: absolute; border: 1px solid #0f0; background: rgba(0,10,0,0.92);
  z-index: 10; min-width: 200px; max-width: 320px; font-size: 12px;
  animation: popIn 0.25s ease-out; box-shadow: 0 0 20px rgba(0,255,0,0.15);
}
@keyframes popIn { from { transform: scale(0.6); opacity: 0; } to { transform: scale(1); opacity: 1; } }
.hack-popup-title {
  background: #0f0; color: #000; padding: 3px 8px; font-weight: bold;
  font-size: 11px; display: flex; justify-content: space-between;
}
.hack-popup-body { padding: 8px 10px 6px; }
.hack-progress-bar {
  width: 100%; height: 12px; background: #001a00; border: 1px solid #0f0;
  margin-top: 6px; overflow: hidden; border-radius: 2px;
}
.hack-progress-fill { height: 100%; background: #0f0; width: 0%; transition: width 0.3s linear; }
.flying-file {
  position: absolute; border: 1px solid #0f0; padding: 5px 12px; font-size: 10px;
  color: #f33; background: rgba(0,0,0,0.85); z-index: 8; white-space: nowrap;
  pointer-events: none; box-shadow: 0 0 12px rgba(255,0,0,0.2);
}
#stage2::after {
  content: ''; position: absolute; inset: 0; pointer-events: none; z-index: 50;
  background: repeating-linear-gradient(0deg, transparent, transparent 2px, rgba(0,255,0,0.03) 2px, rgba(0,255,0,0.03) 4px);
}
@keyframes flicker { 0%,100%{opacity:1} 92%{opacity:1} 93%{opacity:0.7} 94%{opacity:1} 97%{opacity:0.85} 98%{opacity:1} }
#stage2.active { animation: flicker 4s infinite; }

/* ===== STAGE 3: WORDLE ===== */
#stage3 {
  flex-direction: column; align-items: center; justify-content: center;
  background: #000; font-family: 'VT323', monospace; color: #0f0; position: relative;
}
#wordle-container { text-align: center; position: relative; }
#wordle-container.glitch-active { animation: shake 0.12s infinite alternate, rgbSplit 0.2s infinite alternate; }
@keyframes shake { 0%{transform:translate(-2px,1px)} 25%{transform:translate(2px,-1px)} 50%{transform:translate(-1px,2px)} 75%{transform:translate(1px,-2px)} 100%{transform:translate(-2px,-1px)} }
@keyframes rgbSplit { 0%{text-shadow:-2px 0 #f00,2px 0 #00f} 33%{text-shadow:2px 0 #f00,-2px 0 #00f} 66%{text-shadow:-1px 1px #f00,1px -1px #00f} 100%{text-shadow:1px -1px #f00,-1px 1px #00f} }
.wordle-title { font-size: 38px; letter-spacing: 6px; margin-bottom: 6px; }
.wordle-subtitle { font-size: 18px; opacity: 0.6; margin-bottom: 24px; }
.wordle-grid { display: inline-grid; grid-template-columns: repeat(5,56px); grid-template-rows: repeat(6,56px); gap: 6px; margin-bottom: 20px; }
.wordle-cell {
  width: 56px; height: 56px; border: 2px solid #1a3a1a; display: flex;
  align-items: center; justify-content: center; font-size: 32px; font-weight: bold;
  text-transform: uppercase; color: #0f0; transition: transform 0.15s, border-color 0.15s; background: transparent;
}
.wordle-cell.filled { border-color: #0f0; transform: scale(1.05); }
.wordle-cell.correct { background: #0a5f0a; border-color: #0f0; }
.wordle-cell.present { background: #5f5f0a; border-color: #cc0; color: #ff0; }
.wordle-cell.absent { background: #1a1a1a; border-color: #333; color: #555; }
.wordle-cell.reveal { animation: flipCell 0.5s ease forwards; }
@keyframes flipCell { 0%{transform:scaleY(1)} 50%{transform:scaleY(0)} 100%{transform:scaleY(1)} }
.wordle-keyboard { display: flex; flex-direction: column; align-items: center; gap: 5px; }
.wordle-kb-row { display: flex; gap: 4px; }
.wordle-key {
  min-width: 34px; height: 42px; background: #0a2a0a; border: 1px solid #0f0;
  color: #0f0; font-family: 'VT323', monospace; font-size: 18px; cursor: pointer;
  display: flex; align-items: center; justify-content: center; border-radius: 3px;
  transition: background 0.1s; padding: 0 8px; text-transform: uppercase;
}
.wordle-key:hover { background: #0f3f0f; }
.wordle-key.wide { min-width: 58px; font-size: 14px; }
.wordle-key.key-correct { background: #0a5f0a; }
.wordle-key.key-present { background: #5f5f0a; color: #ff0; }
.wordle-key.key-absent { background: #1a1a1a; border-color: #333; color: #444; }
#stage3::after {
  content: ''; position: absolute; inset: 0; pointer-events: none; z-index: 50;
  background: repeating-linear-gradient(0deg, transparent, transparent 2px, rgba(0,255,0,0.03) 2px, rgba(0,255,0,0.03) 4px);
}

/* ===== STAGE 4: RANSOMWARE ===== */
#stage4 { flex-direction: column; align-items: center; justify-content: center; background: #8b0000; font-family: 'Noto Sans', sans-serif; }
.ransom-window { width: 92%; max-width: 820px; background: #fff; border: 2px solid #5a0000; box-shadow: 0 8px 40px rgba(0,0,0,0.5); overflow: hidden; }
.ransom-titlebar { background: linear-gradient(180deg, #d40000 0%, #8b0000 100%); color: #fff; padding: 6px 12px; font-size: 13px; font-weight: 700; display: flex; align-items: center; gap: 8px; }
.ransom-titlebar span { font-size: 18px; }
.ransom-body { display: flex; gap: 0; min-height: 380px; }
.ransom-sidebar { width: 200px; min-width: 200px; background: #250000; color: #fff; padding: 20px 14px; display: flex; flex-direction: column; align-items: center; gap: 16px; text-align: center; }
.ransom-lock-icon { font-size: 60px; }
.ransom-timer-box { background: #1a0000; border: 1px solid #600; padding: 10px; width: 100%; border-radius: 3px; }
.ransom-timer-label { font-size: 10px; color: #f99; margin-bottom: 4px; text-transform: uppercase; letter-spacing: 1px; }
.ransom-timer-value { font-family: 'Share Tech Mono', monospace; font-size: 22px; color: #0f0; }
.ransom-main { flex: 1; padding: 20px 24px; background: #fff0f0; overflow-y: auto; }
.ransom-main h1 { color: #8b0000; font-size: 20px; font-weight: 700; margin-bottom: 10px; }
.ransom-main p { font-size: 13px; color: #333; line-height: 1.6; margin-bottom: 10px; }
.ransom-files { background: #fff; border: 1px solid #daa; padding: 10px 14px; margin: 12px 0; font-family: 'Share Tech Mono', monospace; font-size: 12px; color: #900; line-height: 1.7; }
.ransom-payment { margin-top: 16px; padding-top: 14px; border-top: 1px solid #daa; }
.ransom-payment label { display: block; font-size: 12px; font-weight: 600; color: #555; margin-bottom: 4px; }
.ransom-payment input { width: 100%; padding: 7px 10px; font-size: 13px; border: 1px solid #caa; border-radius: 3px; margin-bottom: 10px; font-family: 'Share Tech Mono', monospace; outline: none; background: #fff; }
.ransom-payment input:focus { border-color: #900; }
.ransom-btc { font-size: 11px; color: #888; word-break: break-all; margin-bottom: 14px; padding: 6px 8px; background: #f5f5f5; border: 1px solid #ddd; border-radius: 2px; }
.ransom-decrypt-btn { background: #8b0000; color: #fff; border: none; padding: 8px 22px; font-size: 13px; font-weight: 600; border-radius: 3px; cursor: pointer; transition: background 0.2s; }
.ransom-decrypt-btn:hover { background: #a00; }
.ransom-escape-label { color: #8b0000 !important; font-weight: 700 !important; font-size: 13px !important; }

/* ===== STAGE 5: VALENTINE ===== */
#stage5 {
  flex-direction: column; align-items: center; justify-content: center;
  background: linear-gradient(-45deg, #ff9a9e, #fad0c4, #fbc2eb, #a18cd1, #ffecd2, #fcb69f);
  background-size: 400% 400%; animation: gradientShift 8s ease infinite;
  position: relative; overflow: hidden; z-index: 1;
}
@keyframes gradientShift { 0%{background-position:0% 50%} 50%{background-position:100% 50%} 100%{background-position:0% 50%} }
.valentine-card {
  background: rgba(255,255,255,0.25); backdrop-filter: blur(20px); -webkit-backdrop-filter: blur(20px);
  border: 1px solid rgba(255,255,255,0.45); border-radius: 24px; padding: 48px 56px;
  text-align: center; max-width: 520px; width: 90%; box-shadow: 0 8px 32px rgba(0,0,0,0.1);
  z-index: 10; animation: cardFloat 3s ease-in-out infinite alternate;
}
@keyframes cardFloat { from{transform:translateY(0)} to{transform:translateY(-8px)} }
.valentine-card h1 { font-family: 'Pacifico', cursive; font-size: 42px; color: #c0392b; margin-bottom: 12px; text-shadow: 0 2px 10px rgba(192,57,43,0.2); }
.valentine-card p { font-family: 'Poppins', sans-serif; font-size: 16px; color: #555; margin-bottom: 28px; line-height: 1.6; }
.valentine-card .subtext { font-size: 13px; color: #888; font-style: italic; }
.valentine-buttons { display: flex; justify-content: center; gap: 20px; margin-top: 20px; position: relative; min-height: 52px; }
.btn-yes {
  background: linear-gradient(135deg, #e74c3c, #c0392b); color: #fff; border: none;
  padding: 14px 44px; font-size: 18px; font-weight: 600; border-radius: 50px; cursor: pointer;
  font-family: 'Poppins', sans-serif; box-shadow: 0 4px 15px rgba(231,76,60,0.4);
  transition: transform 0.2s, box-shadow 0.2s; z-index: 11;
}
.btn-yes:hover { transform: scale(1.08); box-shadow: 0 6px 20px rgba(231,76,60,0.5); }
.btn-no {
  background: rgba(255,255,255,0.6); color: #888; border: 2px solid #ddd;
  padding: 14px 44px; font-size: 18px; font-weight: 600; border-radius: 50px; cursor: pointer;
  font-family: 'Poppins', sans-serif; z-index: 1000; user-select: none;
  transition: none; backdrop-filter: blur(8px); -webkit-backdrop-filter: blur(8px);
  box-shadow: 0 2px 12px rgba(0,0,0,0.1); display: none;
}
.no-taunt {
  position: fixed; font-family: 'Poppins', sans-serif; font-size: 13px;
  color: rgba(192,57,43,0.75); font-style: italic; pointer-events: none;
  z-index: 999; animation: tauntFade 1.8s ease-out forwards; white-space: nowrap;
}
@keyframes tauntFade { 0%{opacity:1;transform:translateY(0) scale(1)} 100%{opacity:0;transform:translateY(-40px) scale(0.9)} }
.yay-display { display: none; z-index: 10; text-align: center; animation: yayPop 0.6s ease-out; }
@keyframes yayPop { 0%{transform:scale(0.3);opacity:0} 60%{transform:scale(1.15)} 100%{transform:scale(1);opacity:1} }
.yay-display h1 { font-family: 'Pacifico', cursive; font-size: 72px; color: #c0392b; text-shadow: 0 4px 20px rgba(192,57,43,0.3); margin-bottom: 10px; }
.yay-display p { font-family: 'Poppins', sans-serif; font-size: 22px; color: #666; }
.heart-float {
  position: absolute; font-size: 24px; opacity: 0; pointer-events: none;
  z-index: 5; animation: floatUp 4s ease-in infinite;
}
@keyframes floatUp {
  0%{opacity:0;transform:translateY(0) scale(0.5) rotate(0deg)}
  10%{opacity:0.8} 90%{opacity:0.3}
  100%{opacity:0;transform:translateY(-100vh) scale(1.2) rotate(30deg)}
}
</style>
</head>
<body>

<audio id="glitchAudio" loop preload="auto"><source src="glitch.mp3" type="audio/mpeg"></audio>
<audio id="songAudio" loop preload="auto"><source src="song.mp3" type="audio/mpeg"></audio>

<!-- STAGE 1 -->
<div id="stage1" class="stage active">
  <div class="opus-header">
    <div class="opus-header-logo">
      <img src="https://upload.wikimedia.org/wikipedia/commons/e/e8/Emory_College_Seal.svg" alt="Emory Shield" onerror="this.style.display='none'">
      <div class="opus-header-brand"><span class="emory-text">EMORY</span><span class="univ-text">UNIVERSITY</span></div>
    </div>
    <div class="opus-header-divider"></div>
    <div class="opus-header-title"><span class="opus-text">OPUS</span><span class="opus-sub">Online Pathway to University Students</span></div>
  </div>
  <div class="opus-body">
    <div class="opus-left">
      <h2>Login to OPUS</h2>
      <label for="netid">Network ID</label><input type="text" id="netid" autocomplete="off">
      <label for="passwd">Password</label><input type="password" id="passwd">
      <button class="opus-login-btn" id="loginBtn">Login</button>
    </div>
    <div class="opus-right">
      <div class="opus-info-box">
        <strong>Need help?</strong><br><br>
        <a href="#">Forgot Network ID?</a><br><a href="#">Reset Password</a><br><a href="#">IT Help Desk</a><br><br>
        Use your Emory Network ID and password to log in.<br>Having trouble with Duo? <a href="#">Click here</a>.
        <div class="warn">‚ö†Ô∏è This system is for authorized Emory University users only. Use of this system constitutes consent to monitoring. Unauthorized access is a violation of federal law.</div>
      </div>
    </div>
  </div>
</div>

<!-- STAGE 2 -->
<div id="stage2" class="stage">
  <canvas id="matrixCanvas"></canvas>
  <div class="hud-panel" id="downloadPanel"><div class="hud-panel-title">‚¨á File Exfiltration</div><div id="downloadBody"></div></div>
  <div class="hud-panel" id="netGraph"><div class="hud-panel-title">‚óà Network Activity</div><canvas id="netGraphCanvas"></canvas></div>
  <div class="hud-panel" id="ipScanner"><div class="hud-panel-title">‚äï Port Scanner</div><div id="ipScannerBody"></div></div>
  <div class="hud-panel" id="fileTree"><div class="hud-panel-title">‚äü File System</div><div id="fileTreeBody"></div></div>
  <div id="terminal"></div>
</div>

<!-- STAGE 3 -->
<div id="stage3" class="stage">
  <div id="wordle-container">
    <div class="wordle-title">PASSWORD REQUIRED</div>
    <div class="wordle-subtitle">[ 5-LETTER OVERRIDE KEY ]</div>
    <div class="wordle-grid" id="wordleGrid"></div>
    <div class="wordle-keyboard" id="wordleKeyboard"></div>
  </div>
</div>

<!-- STAGE 4 -->
<div id="stage4" class="stage">
  <div class="ransom-window">
    <div class="ransom-titlebar"><span>üîí</span> Wana Decrypt0r 2.0</div>
    <div class="ransom-body">
      <div class="ransom-sidebar">
        <div class="ransom-lock-icon">üîê</div>
        <div class="ransom-timer-box"><div class="ransom-timer-label">Files Lost In</div><div class="ransom-timer-value" id="timer1">02:59:47</div></div>
        <div class="ransom-timer-box"><div class="ransom-timer-label">Price Raised In</div><div class="ransom-timer-value" id="timer2">05:59:47</div></div>
        <div style="font-size:11px;color:#f99;margin-top:auto;">Payment: 0.1742 BTC</div>
      </div>
      <div class="ransom-main">
        <h1>Ooops, your files have been encrypted!</h1>
        <p>Your important academic files have been encrypted with military-grade RSA-4096 + AES-256. No one can recover your files without our decryption service.</p>
        <p style="font-weight:600;color:#8b0000;">The following Canvas LMS courses and files have been destroyed:</p>
        <div class="ransom-files">‚úó HEBR 102 ‚Äî All assignments DELETED<br>‚úó CHEM 202L ‚Äî Lab notebook CORRUPTED<br>‚úó BUS 292 ‚Äî Course WITHDRAWN<br>‚úó NBB 499R ‚Äî Resignation email SENT to professor<br>‚úó Resume_Final_v3.docx ‚Äî LOCKED<br>‚úó Lab_Report_Draft.pdf ‚Äî LOCKED</div>
        <div class="ransom-payment">
          <label>Send Bitcoin to:</label>
          <div class="ransom-btc">1A1zP1eP5QGefi2DMPTfTL5SLmv7DivfNa</div>
          <label class="ransom-escape-label">‚ö° EMERGENCY OVERRIDE: ENTER 7-DIGIT STUDENT ID</label>
          <input type="text" id="studentIdInput" placeholder="e.g. 1234567" maxlength="7">
          <button class="ransom-decrypt-btn" id="decryptBtn">DECRYPT FILES</button>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- STAGE 5 -->
<div id="stage5" class="stage">
  <div class="valentine-card" id="valentineCard">
    <h1>Will you be my Valentine?</h1>
    <p>I went through all of that just to ask you this one little question ‚ù§Ô∏è</p>
    <p class="subtext">(I promise I didn't <em>actually</em> hack your grades... probably)</p>
    <div class="valentine-buttons" id="valentineButtons">
      <button class="btn-yes" id="btnYes">YES üíï</button>
      <button class="btn-no" id="btnNo">NO üíî</button>
    </div>
  </div>
  <div class="yay-display" id="yayDisplay"><h1>YAY!! üéâüíï</h1><p>I knew you'd say yes!</p></div>
</div>

<script>
const glitchAudio = document.getElementById('glitchAudio');
const songAudio = document.getElementById('songAudio');

function showStage(n) {
  document.querySelectorAll('.stage').forEach(s => s.classList.remove('active'));
  document.getElementById('stage' + n).classList.add('active');
}

/* =============== STAGE 1 =============== */
document.getElementById('loginBtn').addEventListener('click', () => {
  if (!document.getElementById('netid').value.trim() || !document.getElementById('passwd').value.trim()) { alert('Please enter your Network ID and Password.'); return; }
  glitchAudio.play().catch(()=>{});
  showStage(2); startHacking();
});
document.getElementById('passwd').addEventListener('keydown', e => { if (e.key==='Enter') document.getElementById('loginBtn').click(); });

/* =============== STAGE 2 =============== */
function startHacking() {
  const terminal = document.getElementById('terminal');
  const stage2 = document.getElementById('stage2');

  // -- Matrix rain --
  const mc = document.getElementById('matrixCanvas');
  const mctx = mc.getContext('2d');
  mc.width = window.innerWidth; mc.height = window.innerHeight;
  const cols = Math.floor(mc.width / 14);
  const drops = Array(cols).fill(1);
  const mChars = '„Ç¢„Ç§„Ç¶„Ç®„Ç™„Ç´„Ç≠„ÇØ„Ç±„Ç≥„Çµ„Ç∑„Çπ„Çª„ÇΩ„Çø„ÉÅ„ÉÑ„ÉÜ„Éà„Éä„Éã„Éå„Éç„Éé„Éè„Éí„Éï„Éò„Éõ„Éû„Éü„É†„É°„É¢„É§„É¶„É®„É©„É™„É´„É¨„É≠„ÉØ„É≤„É≥0123456789ABCDEF';
  function drawMatrix() {
    mctx.fillStyle = 'rgba(0,0,0,0.05)';
    mctx.fillRect(0,0,mc.width,mc.height);
    mctx.fillStyle = '#0f0'; mctx.font = '13px Share Tech Mono';
    for (let i=0;i<drops.length;i++) {
      mctx.fillText(mChars[Math.floor(Math.random()*mChars.length)], i*14, drops[i]*14);
      if (drops[i]*14 > mc.height && Math.random()>0.975) drops[i]=0;
      drops[i]++;
    }
  }
  const matrixInt = setInterval(drawMatrix, 45);

  // -- Network graph --
  const ngc = document.getElementById('netGraphCanvas');
  const ngctx = ngc.getContext('2d');
  ngc.width = 278; ngc.height = 96;
  const gData = Array(70).fill(0);
  function drawGraph() {
    gData.shift(); gData.push(Math.random()*80+10);
    ngctx.clearRect(0,0,ngc.width,ngc.height);
    ngctx.strokeStyle='#0f0'; ngctx.lineWidth=1.5; ngctx.shadowColor='#0f0'; ngctx.shadowBlur=4;
    ngctx.beginPath();
    for (let i=0;i<gData.length;i++){const x=(i/gData.length)*ngc.width;const y=ngc.height-(gData[i]/100)*ngc.height;i===0?ngctx.moveTo(x,y):ngctx.lineTo(x,y);}
    ngctx.stroke(); ngctx.shadowBlur=0;
    ngctx.fillStyle='#050'; ngctx.font='9px Share Tech Mono';
    ngctx.fillText('TX/RX kB/s',4,10);
    ngctx.fillText(Math.round(gData[gData.length-1])+' kB/s',ngc.width-55,10);
  }
  const graphInt = setInterval(drawGraph, 200);

  // -- IP scanner --
  const ipBody = document.getElementById('ipScannerBody');
  const subnets=['10.17.42.','172.16.8.','192.168.1.','10.0.5.'];
  const ports=[22,80,443,3306,8080,8443,21,25,587,993,3389,5432,27017];
  function scanIP(){
    const s=subnets[Math.floor(Math.random()*subnets.length)];
    const h=Math.floor(Math.random()*254)+1;
    const p=ports[Math.floor(Math.random()*ports.length)];
    const open=Math.random()>0.4;
    const line=document.createElement('div');
    line.className='ip-line '+(open?'hit':'blocked');
    line.textContent=`${s}${h}:${p} ${open?'‚Üí OPEN':'‚Üí BLOCKED'}`;
    ipBody.appendChild(line);
    if(ipBody.children.length>25) ipBody.removeChild(ipBody.firstChild);
    ipBody.scrollTop=ipBody.scrollHeight;
  }
  const ipInt = setInterval(scanIP, 600);

  // -- File tree --
  const ftBody = document.getElementById('fileTreeBody');
  const filePaths=['üìÅ /home/user/Documents/','  üìÑ Resume_Final_v3.docx','  üìÑ Cover_Letter_McKinsey.pdf','  üìÑ Personal_Statement_v7.docx',
    'üìÅ /home/user/Classes/','  üìÑ Lab_Report_Draft.pdf','  üìÑ Orgo_Notes_Ch12.pdf','  üìÑ MCAT_Study_Plan.xlsx','  üìÑ HEBR_HW_03.docx',
    '  üìÑ CHEM_Prelab_Report.pdf','  üìÑ BUS_Case_Study.xlsx','  üìÑ NBB499R_Data.csv',
    'üìÅ /home/user/Pictures/','  üñº IMG_2847.jpg','  üñº IMG_2848.jpg','  üñº Screenshot_01.png',
    'üìÅ /home/user/.config/','  üìÑ chrome_passwords.db','  üìÑ ssh_key_rsa',
    'üìÅ /home/user/Downloads/','  üìÑ Lecture_Slides_Week10.pptx','  üìÑ Study_Guide_Final.pdf'];
  let ftIdx=0;
  function addTreeItem(){
    if(ftIdx>=filePaths.length) return;
    const item=document.createElement('div'); item.className='tree-item'; item.textContent=filePaths[ftIdx];
    ftBody.appendChild(item); ftBody.scrollTop=ftBody.scrollHeight;
    setTimeout(()=>{item.classList.add('encrypting');item.textContent+=' ‚üµ ENCRYPTING';},1500+Math.random()*1000);
    setTimeout(()=>{item.classList.remove('encrypting');item.classList.add('encrypted');item.textContent=item.textContent.replace(' ‚üµ ENCRYPTING',' üîí');},3500+Math.random()*1500);
    ftIdx++;
  }
  const ftInt = setInterval(addTreeItem, 2800);

  // -- Downloads --
  const dlBody = document.getElementById('downloadBody');
  const dlFiles=[
    {name:'chrome_passwords.db',size:'2.4 MB',fail:false},{name:'EmorySSO_Session.cookie',size:'128 B',fail:false},
    {name:'duo_bypass_token.bin',size:'4.1 KB',fail:false},{name:'canvas_api_dump.json',size:'18.7 MB',fail:false},
    {name:'saml_assertion.xml',size:'6.2 KB',fail:false},{name:'HEBR102_gradebook.csv',size:'342 KB',fail:false},
    {name:'CHEM202L_notebook.docx',size:'1.8 MB',fail:false},{name:'rsa4096_private.pem',size:'3.2 KB',fail:false},
    {name:'student_records.sql',size:'45.3 MB',fail:false},{name:'smtp_relay_creds.txt',size:'512 B',fail:false},
    {name:'NBB499R_research_data.zip',size:'127 MB',fail:true},{name:'kernel_exploit.sys',size:'8.9 MB',fail:false}];
  let dlIdx=0;
  function startDownload(){
    if(dlIdx>=dlFiles.length) return;
    const f=dlFiles[dlIdx];
    const item=document.createElement('div'); item.className='dl-item';
    item.innerHTML=`<div class="dl-item-name"><span>‚Üì ${f.name}</span><span>${f.size}</span></div><div class="dl-item-bar"><div class="dl-item-fill"></div></div><div class="dl-item-size">0%</div>`;
    dlBody.appendChild(item); dlBody.parentElement.scrollTop=dlBody.parentElement.scrollHeight;
    const fill=item.querySelector('.dl-item-fill'),pct_l=item.querySelector('.dl-item-size');
    let pct=0; const spd=3+Math.random()*5;
    const di=setInterval(()=>{
      pct+=spd+Math.random()*3;
      if(f.fail&&pct>70){clearInterval(di);fill.style.width='70%';fill.classList.add('fail');pct_l.textContent='ERROR ‚Äî Connection reset';pct_l.style.color='#f33';return;}
      if(pct>=100){pct=100;clearInterval(di);fill.classList.add('complete');}
      fill.style.width=pct+'%';
      pct_l.textContent=Math.round(pct)+'% ‚Äî '+(pct>=100?'EXFILTRATED ‚úì':'downloading...');
      if(pct>=100)pct_l.style.color='#0ff';
    },250);
    dlIdx++;
  }
  const dlInt=setInterval(startDownload,4500);
  setTimeout(startDownload,500);

  // -- Terminal --
  const Q=[];
  function L(t,c=''){Q.push({text:t,cls:c});}
  L('> Initializing exploit framework v4.2.0...','');
  L('> Loading modules: net.scanner, auth.bypass, fs.crypt, smtp.forge','');
  L('[*] Target acquired: OPUS (opus.emory.edu)','cyan');
  L('[*] Resolving DNS... 170.140.223.41','');
  L('[*] TCP handshake complete (TLSv1.3)','');
  L('[*] Probing authentication endpoints...','');
  L('','');
  L('‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê','yellow');
  L('  ‚ñà‚ñà PHASE 1: AUTHENTICATION BYPASS ‚ñà‚ñà','yellow');
  L('‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê','yellow');
  L('','');
  L('[*] Intercepting SSO handshake at /idp/profile/SAML2/POST...','');
  L('[*] Capturing SAML assertion... (2048 bytes)','');
  L('[+] SAML token extracted ‚Äî forging EmorySSO_Session cookie','cyan');
  L('[+] Session hijack successful ‚Äî authenticated as target user','cyan');
  L('','');
  L('[*] Duo Security MFA challenge detected...','yellow');
  L('[*] Injecting rogue push notification to registered device...','');
  L('[*] Exploiting Duo API callback race condition (CVE-2024-0312)...','');
  L('[*] Spoofing bypass token ‚Üí duo-callback.emory.edu:443...','');
  L('[*] Waiting for Duo handshake timeout...','dim');
  L('[+] ‚ñà‚ñà DUO 2FA BYPASSED ‚ñà‚ñà','cyan');
  L('[+] Full authenticated session established ‚úì','cyan');
  L('','');
  L('‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê','yellow');
  L('  ‚ñà‚ñà PHASE 2: FILE SYSTEM ENUMERATION ‚ñà‚ñà','yellow');
  L('‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê','yellow');
  L('','');
  L('[*] Mounting network shares: //files.emory.edu/home/','');
  L('[*] Scanning /Documents/...','');
  L('    ‚Üí Resume_Final_v3.docx (245 KB)','dim');
  L('    ‚Üí Cover_Letter_McKinsey.pdf (132 KB)','dim');
  L('    ‚Üí Personal_Statement_v7_FINAL_final.docx (89 KB)','dim');
  L('[*] Scanning /Classes/...','');
  L('    ‚Üí Lab_Report_Draft.pdf (1.2 MB)','dim');
  L('    ‚Üí Orgo_Notes_Ch12.pdf (4.7 MB)','dim');
  L('    ‚Üí MCAT_Study_Plan.xlsx (567 KB)','dim');
  L('[*] Scanning /Pictures/ ‚Äî 847 files (3.2 GB)','');
  L('[*] Scanning /Downloads/ ‚Äî 134 files (1.1 GB)','');
  L('[*] Scanning /.config/ ‚Äî extracting credential stores...','yellow');
  L('[+] File enumeration complete ‚Äî 1,247 files indexed across 4 drives','cyan');
  L('','');
  L('[*] Generating RSA-4096 keypair for key encapsulation...','');
  L('[*] Encrypting all files with AES-256-CBC...','red');
  L('[*] ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà 100%','red');
  L('[+] Encryption key: 7f3a9b...c4e128 (exfiltrated to C2 server)','red');
  L('[+] ‚ñà‚ñà ALL LOCAL FILES ENCRYPTED ‚ñà‚ñà','red');
  L('','');
  L('‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê','yellow');
  L('  ‚ñà‚ñà PHASE 3: CANVAS LMS INFILTRATION ‚ñà‚ñà','yellow');
  L('‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê','yellow');
  L('','');
  L('[*] Connecting to Canvas REST API: canvas.emory.edu/api/v1/','');
  L('[*] Bearer token injected ‚Äî enumerating enrolled courses...','');
  L('','');
  L('  ‚îå‚îÄ HEBR 102: Elementary Hebrew II ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ','yellow');
  L('[*] Fetching assignment list... (14 assignments found)','');
  L('[*] DELETE /api/v1/courses/HEBR102/assignments/*','red');
  L('[+] ‚úó ALL HEBR 102 ASSIGNMENTS DELETED','red');
  L('','');
  L('  ‚îå‚îÄ CHEM 202L: Organic Chemistry Lab ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ','yellow');
  L('[*] Locating lab notebook submissions...','');
  L('[*] Injecting corrupt byte sequences into .docx OLE2 containers...','');
  L('[+] ‚úó CHEM 202L LAB NOTEBOOK CORRUPTED','red');
  L('','');
  L('  ‚îå‚îÄ BUS 292: Business Analytics ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ','yellow');
  L('[*] POST /api/v1/courses/BUS292/enrollments/self/withdraw','');
  L('[+] ‚úó BUS 292 ‚Äî COURSE WITHDRAWN (recorded on transcript)','red');
  L('','');
  L('  ‚îå‚îÄ NBB 499R: Neuroscience Research ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ','yellow');
  L('[*] Harvesting professor email from faculty directory...','');
  L('[*] Connecting to SMTP relay: smtp.emory.edu:587 (STARTTLS)','');
  L('[*] Composing forged resignation email from student account...','');
  L('[*] Subject: "Resignation from NBB 499R - Effective Immediately"','red');
  L('[*] Body: "I am writing to resign from the research lab effective','');
  L('    immediately. I have decided to pursue a career in','');
  L('    competitive eating instead. Thank you for everything."','');
  L('[*] Sending via authenticated SMTP relay...','');
  L('[+] ‚úó EMAIL SENT SUCCESSFULLY ‚Äî resignation confirmed','red');
  L('','');
  L('‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê','yellow');
  L('  ‚ñà‚ñà PHASE 4: CREDENTIAL HARVEST ‚ñà‚ñà','yellow');
  L('‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê','yellow');
  L('','');
  L('[*] Dumping Chromium credential store (Login Data SQLite)...','');
  L('[*] Decrypting with DPAPI master key...','');
  L('    ‚Üí Netflix: ‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢','dim');
  L('    ‚Üí Spotify: ‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢','dim');
  L('    ‚Üí Instagram: ‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢','dim');
  L('    ‚Üí Canvas LMS: ‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢','dim');
  L('    ‚Üí Gmail: ‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢','dim');
  L('[+] 23 credentials harvested and exfiltrated','cyan');
  L('','');
  L('[*] Installing persistence via Windows Task Scheduler...','');
  L('[*] Modifying registry: HKLM\\Software\\Microsoft\\CurrentVersion\\Run','');
  L('[+] Backdoor installed ‚Äî survives reboot ‚úì','red');
  L('[*] Covering tracks ‚Äî clearing Event Viewer logs...','');
  L('[+] Logs purged ‚úì','');
  L('','');
  L('‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê','red');
  L('  ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  KERNEL PANIC  ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà','red');
  L('‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê','red');
  L('','');
  L('FATAL: Unrecoverable system error in module ntoskrnl.exe','red');
  L('STOP: 0x0000007E (0xFFFFFFFFC0000005, 0xFFFFF80002A0B6C1)','red');
  L('CRITICAL_STRUCTURE_CORRUPTION ‚Äî memory dump initiated','red');
  L('','');
  L('[!] System integrity compromised. Rebooting into recovery...','red');
  L('[!] RECOVERY MODE: PASSWORD AUTHENTICATION REQUIRED','yellow');

  let cur=0;
  const termInt=setInterval(()=>{
    if(cur>=Q.length){clearInterval(termInt);setTimeout(()=>{clearInterval(matrixInt);clearInterval(graphInt);clearInterval(ipInt);clearInterval(ftInt);clearInterval(dlInt);showStage(3);initWordle();},2500);return;}
    const e=Q[cur]; const d=document.createElement('div');
    d.className='term-line'+(e.cls?' '+e.cls:''); d.textContent=e.text;
    terminal.appendChild(d); terminal.scrollTop=terminal.scrollHeight; cur++;
  },650);

  // Popups
  [{t:'AUTH_BYPASS.exe',b:'Cracking Duo Security...',d:3000,dur:5500},{t:'ENUM_FILES.exe',b:'Scanning network shares...',d:12000,dur:5000},
   {t:'AES_ENCRYPT.exe',b:'Encrypting AES-256-CBC...',d:20000,dur:6000},{t:'CANVAS_API.exe',b:'Injecting Canvas endpoints...',d:30000,dur:7000},
   {t:'SMTP_FORGE.exe',b:'Forging email headers...',d:42000,dur:5500},{t:'CRED_DUMP.exe',b:'Decrypting DPAPI store...',d:52000,dur:5000},
   {t:'PERSIST.exe',b:'Installing backdoor...',d:58000,dur:4000}
  ].forEach(c=>setTimeout(()=>createPopup(c.t,c.b,c.dur),c.d));

  // Flying files
  const fNames=['Resume_Final_v3.docx','Lab_Report_Draft.pdf','MCAT_Study_Plan.xlsx','Personal_Statement.docx','Cover_Letter.pdf','Orgo_Notes.pdf','HEBR_HW_03.docx','CHEM_Prelab.pdf','BUS_Case_Study.xlsx','NBB499R_Data.csv','chrome_passwords.db','ssh_key_rsa'];
  for(let i=0;i<14;i++) setTimeout(()=>createFlyingFile(fNames[i%fNames.length]),4000+i*4200);

  function createPopup(title,body,duration){
    const p=document.createElement('div');p.className='hack-popup';
    p.style.left=(30+Math.random()*Math.max(window.innerWidth-340,100))+'px';
    p.style.top=(20+Math.random()*Math.max(window.innerHeight*0.42-80,50))+'px';
    p.innerHTML=`<div class="hack-popup-title"><span>${title}</span><span>‚úï</span></div><div class="hack-popup-body">${body}<div class="hack-progress-bar"><div class="hack-progress-fill"></div></div></div>`;
    stage2.appendChild(p);
    const fill=p.querySelector('.hack-progress-fill');let pr=0;
    const pi=setInterval(()=>{pr+=Math.random()*8+2;if(pr>100)pr=100;fill.style.width=pr+'%';if(pr>=100)clearInterval(pi);},duration/15);
    setTimeout(()=>{p.style.transition='opacity 0.3s';p.style.opacity='0';setTimeout(()=>p.remove(),400);},duration);
  }
  function createFlyingFile(name){
    const f=document.createElement('div');f.className='flying-file';f.textContent='üîí FILE LOCKED: '+name;
    const sX=-220,sY=30+Math.random()*(window.innerHeight*0.38);
    f.style.left=sX+'px';f.style.top=sY+'px';stage2.appendChild(f);
    const spd=1.5+Math.random()*2,wob=18+Math.random()*25,ws=0.018+Math.random()*0.02;
    let x=sX,t=Math.random()*Math.PI*2;
    (function a(){x+=spd;t+=ws;f.style.left=x+'px';f.style.top=(sY+Math.sin(t)*wob)+'px';
      if(x<window.innerWidth+250)requestAnimationFrame(a);else f.remove();})();
  }
}

/* =============== STAGE 3: WORDLE =============== */
function initWordle(){
  const SECRET='CUTIE',grid=document.getElementById('wordleGrid'),kb=document.getElementById('wordleKeyboard'),ctr=document.getElementById('wordle-container');
  let cRow=0,cCol=0,over=false,started=false;
  grid.innerHTML='';for(let i=0;i<30;i++){const c=document.createElement('div');c.className='wordle-cell';grid.appendChild(c);}
  const kbR=['QWERTYUIOP'.split(''),'ASDFGHJKL'.split(''),['ENTER',..."ZXCVBNM".split(''),'‚å´']];
  kb.innerHTML='';kbR.forEach(r=>{const rd=document.createElement('div');rd.className='wordle-kb-row';r.forEach(k=>{const b=document.createElement('button');b.className='wordle-key'+(k.length>1?' wide':'');b.textContent=k;b.dataset.key=k;b.addEventListener('click',()=>hk(k));rd.appendChild(b);});kb.appendChild(rd);});
  const ks={},gc=(r,c)=>grid.children[r*5+c];
  function hk(k){if(over)return;if(k==='‚å´'){if(cCol>0){cCol--;const c=gc(cRow,cCol);c.textContent='';c.classList.remove('filled');}}else if(k==='ENTER'){if(cCol===5)submit();}else if(/^[A-Z]$/.test(k)&&cCol<5){const c=gc(cRow,cCol);c.textContent=k;c.classList.add('filled');cCol++;}}
  function submit(){
    if(!started){started=true;ctr.classList.add('glitch-active');}
    let g='';for(let i=0;i<5;i++)g+=gc(cRow,i).textContent;
    const res=ev(g,SECRET);
    for(let i=0;i<5;i++){const c=gc(cRow,i),l=g[i],s=res[i];
      setTimeout(()=>{c.classList.add('reveal');setTimeout(()=>{c.classList.add(s);if(!ks[l]||s==='correct'||(s==='present'&&ks[l]==='absent')){ks[l]=s;const kk=kb.querySelector(`[data-key="${l}"]`);if(kk)kk.className='wordle-key key-'+s;}},250);},i*300);}
    setTimeout(()=>{if(g===SECRET){over=true;setTimeout(()=>{ctr.classList.remove('glitch-active');alert('üîì PASSWORD ACCEPTED... SYSTEM CRASH IMMINENT');showStage(4);startRansomTimer();},600);}else{cRow++;cCol=0;if(cRow>=6){over=true;setTimeout(()=>{ctr.classList.remove('glitch-active');alert('‚ùå SYSTEM CRASH ‚Äî PASSWORD BRUTE FORCE FAILED');showStage(4);startRansomTimer();},600);}}},5*300+400);
  }
  function ev(g,s){const r=Array(5).fill('absent'),sa=s.split(''),ga=g.split(''),u=Array(5).fill(false);for(let i=0;i<5;i++)if(ga[i]===sa[i]){r[i]='correct';u[i]=true;}for(let i=0;i<5;i++)if(r[i]!=='correct')for(let j=0;j<5;j++)if(!u[j]&&ga[i]===sa[j]){r[i]='present';u[j]=true;break;}return r;}
  document.addEventListener('keydown',function wk(e){if(!document.getElementById('stage3').classList.contains('active'))return;if(e.key==='Enter')hk('ENTER');else if(e.key==='Backspace')hk('‚å´');else if(/^[a-zA-Z]$/.test(e.key))hk(e.key.toUpperCase());});
}

/* =============== STAGE 4 =============== */
function startRansomTimer(){
  let t1=10787,t2=21587;
  const f=s=>`${String(Math.floor(s/3600)).padStart(2,'0')}:${String(Math.floor((s%3600)/60)).padStart(2,'0')}:${String(s%60).padStart(2,'0')}`;
  const i=setInterval(()=>{t1=Math.max(0,t1-1);t2=Math.max(0,t2-1);document.getElementById('timer1').textContent=f(t1);document.getElementById('timer2').textContent=f(t2);if(!document.getElementById('stage4').classList.contains('active'))clearInterval(i);},1000);
}
document.getElementById('decryptBtn').addEventListener('click',()=>{if(/^\d{7}$/.test(document.getElementById('studentIdInput').value.trim())){showStage(5);startValentine();}else alert('‚ö†Ô∏è ERROR: Invalid Student ID. Must be exactly 7 digits.');});
document.getElementById('studentIdInput').addEventListener('keydown',e=>{if(e.key==='Enter')document.getElementById('decryptBtn').click();});

/* =============== STAGE 5 =============== */
function startValentine(){
  glitchAudio.pause();glitchAudio.currentTime=0;songAudio.play().catch(()=>{});
  const s5=document.getElementById('stage5');
  setInterval(()=>{const h=document.createElement('div');h.className='heart-float';h.textContent=['‚ù§Ô∏è','üíï','üíñ','üíó','üíò','‚ú®','üå∏'][Math.floor(Math.random()*7)];h.style.left=Math.random()*100+'%';h.style.bottom='-30px';h.style.animationDuration=(3+Math.random()*3)+'s';h.style.fontSize=(16+Math.random()*20)+'px';s5.appendChild(h);setTimeout(()=>h.remove(),6000);},400);
  initRunawayNo();
}

/* =============== RUNAWAY NO BUTTON =============== */
function initRunawayNo(){
  const btn=document.getElementById('btnNo');

  // Move button to <body> so it escapes any overflow:hidden / stacking context
  document.body.appendChild(btn);
  btn.style.position='fixed';
  btn.style.display='block';

  let bx=0, by=0, vx=0, vy=0;
  let mx=-9999, my=-9999, attempts=0;
  let ready=false;

  const taunts=[
    "Nice try! üòè","Nope!","Too slow!","Haha catch me!","Really? ü§®",
    "Can't touch this üíÉ","Think again!","Almost!","Just say YES üíï",
    "I'm too fast üèÉ","Not happening!","Missed me!","Oops!","Keep trying üòÇ",
    "You sure about that?","Come on now...","So close! ...not really"
  ];

  function showTaunt(){
    const t=document.createElement('div');t.className='no-taunt';
    t.textContent=taunts[attempts%taunts.length];
    t.style.left=(bx+btn.offsetWidth/2-50)+'px';
    t.style.top=(by-10)+'px';
    document.body.appendChild(t);setTimeout(()=>t.remove(),1900);
  }

  function teleport(){
    attempts++; showTaunt();
    const m=60, bw=btn.offsetWidth||140, bh=btn.offsetHeight||50;
    bx=m+Math.random()*(window.innerWidth-bw-m*2);
    by=m+Math.random()*(window.innerHeight-bh-m*2);
    vx=(Math.random()-0.5)*14; vy=(Math.random()-0.5)*14;
    btn.style.left=bx+'px'; btn.style.top=by+'px';
  }

  // Wait one frame so the browser has painted the button and we can read its size
  requestAnimationFrame(()=>{requestAnimationFrame(()=>{
    // Place it centered-ish, offset right of center (where it would be next to YES)
    const bw=btn.offsetWidth||140, bh=btn.offsetHeight||50;
    bx=window.innerWidth/2+40;
    by=window.innerHeight/2+60;
    btn.style.left=bx+'px'; btn.style.top=by+'px';
    ready=true;
  });});

  // Track mouse/touch everywhere
  document.addEventListener('mousemove',e=>{mx=e.clientX;my=e.clientY;});
  document.addEventListener('touchmove',e=>{mx=e.touches[0].clientX;my=e.touches[0].clientY;},{passive:true});
  document.addEventListener('touchstart',e=>{mx=e.touches[0].clientX;my=e.touches[0].clientY;},{passive:true});

  // Failsafe: any contact = instant teleport
  btn.addEventListener('mouseenter',teleport);
  btn.addEventListener('touchstart',e=>{e.preventDefault();teleport();});
  btn.addEventListener('click',e=>{e.preventDefault();e.stopPropagation();teleport();});

  // Physics loop
  function tick(){
    if(!ready||!document.getElementById('stage5').classList.contains('active')){requestAnimationFrame(tick);return;}
    const bw=btn.offsetWidth||140, bh=btn.offsetHeight||50;
    const cx=bx+bw/2, cy=by+bh/2;
    const dx=cx-mx, dy=cy-my, dist=Math.sqrt(dx*dx+dy*dy);
    const R=300;
    if(dist<R&&dist>0){
      const force=Math.pow((R-dist)/R,1.5)*18;
      vx+=(dx/dist)*force; vy+=(dy/dist)*force;
      if(dist<120){vx+=(dx/dist)*10;vy+=(dy/dist)*10;}
      if(dist<50)teleport();
    }
    vx*=0.90; vy*=0.90; bx+=vx; by+=vy;
    const mg=5, MX=window.innerWidth-bw-mg, MY=window.innerHeight-bh-mg;
    if(bx<mg){bx=mg;vx=Math.abs(vx)*0.7;} if(bx>MX){bx=MX;vx=-Math.abs(vx)*0.7;}
    if(by<mg){by=mg;vy=Math.abs(vy)*0.7;} if(by>MY){by=MY;vy=-Math.abs(vy)*0.7;}
    btn.style.left=bx+'px'; btn.style.top=by+'px';
    requestAnimationFrame(tick);
  }
  requestAnimationFrame(tick);
}

/* YES BUTTON */
document.getElementById('btnYes').addEventListener('click',()=>{
  document.getElementById('valentineCard').style.display='none';
  document.getElementById('btnNo').style.display='none';
  document.getElementById('yayDisplay').style.display='block';
  const end=Date.now()+5000;
  (function f(){
    confetti({particleCount:5,angle:60,spread:55,origin:{x:0}});
    confetti({particleCount:5,angle:120,spread:55,origin:{x:1}});
    confetti({particleCount:3,angle:90,spread:120,origin:{y:0.6}});
    if(Date.now()<end)requestAnimationFrame(f);
  })();
});
</script>
</body>
</html>
